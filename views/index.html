<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->

  <title>Info Planet Servis</title><!-- Bootstrap -->
  <link href="static/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
  <link rel="stylesheet" href=
  "https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.10.0/css/bootstrap-select.min.css"
  type="text/css" />
  <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
          <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->
  <link rel="stylesheet" href=
  "http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" type=
  "text/css" />
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.2/jquery.min.js" type=
  "text/javascript">
</script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"
  integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS"
  crossorigin="anonymous" type="text/javascript">
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/vue/1.0.22/vue.min.js"
		type="text/javascript">
</script>


<!-- Nije spojen dobro sa static folderom pa koristim CDN kasnije &#263;emo ispraviti sve
kad bude optimizacija -->

  <style type="text/css">
/*<![CDATA[*/

  .admin-panel{
        background-image: url('static/back.jpg');
        background-size: cover;
        height: 100vh;
  }
  .admin-panel .overlay{
        background: rgba(255,255,255,0.7);
        height: 100%;
  }
  .unos-naloga{
        width: 100%;
  }
  .unos-naloga h4{
        margin: 10px auto;
  }
  .unos-naloga .container{
        margin: 20px auto;
  }

  .admin-panel .korisnik,
  .admin-panel .opcije,
  .admin-panel .zahtijevi
  {
  margin: 30px auto;
  }


  .admin-panel .opcije .btn{
        margin: 5px auto;
  }

  .site-head{
        text-align:center;

  }

  .korisnik, .opcije , .nalozi{
        background: rgba(255,255,255,0.8);
        box-shadow: 1px 1px 2px 2px gray;
        padding: 15px;  
  }
  /*]]>*/
  </style>
</head>

<body>


  <div class="admin-panel">
    <div class="overlay">
      <div class="container">
        <div class="row">
          <div class="col-md-12">
            <div class="site-head">
              <h1>Control Panel</h1>

              <h4>Info Planet</h4>
            </div>

            <div class="row korisnik">
			<div class="col-md-6">
              <h4>Korisnik</h4>

              <p>Signed in as <span class="label label-success">Dubo</span> Privileges
              <span class="label label-info">Administrator</span></p><br />

              <h4>Zahtijevi</h4>

              <p>Zahtijeva preostalo <span class="label label-danger">2</span></p>
            </div>
			
			<div class="col-md-6">
              <h5>Rad s korisnicima</h5><button type="button" class=
                  "btn btn-primary"> Dodaj korisnika</button><br />
                  <button type="button" class="btn btn-primary"> Izmjeni
                  korisnika</button><br />
                  <button type="button" class="btn btn-primary"> Pregledaj sve
                  korisnike</button><br />
            </div>
			
			</div>

            <div class="opcije">
              <div class="list-inline text-center">
                
                  <h5>Akcije</h5><button type="button" class="btn btn-primary"
                  data-toggle="modal" data-target="#myModal"> Unos servisnog
                  naloga</button>
              </div>
            </div>
			
			<div class="nalozi" >
			<h3 class="text-center"><b>Pregled naloga</b></h3>
			<div id="nalozi">
			  <div v-for="nalog in nalozi">
              <div class="panel panel-danger">
				 <div class="panel-heading">
					<div class="row">
						<div class="col-md-3">
							<b>Status naloga :</b> {{nalog.status}}
						</div>
						<div class="col-md-3">
							<b>Kupac :</b> {{nalog.ime}} {{nalog.prezime}}
						</div>
						
						<div class="col-md-2">
							<b>Vrsta uređaja :</b> {{nalog.vrsta}}
						</div>
						<div class="col-md-2">
							<b>Marka uređaja :</b>{{nalog.marka}}
						</div>
						<div class="col-md-2">
							<button type="button" class="btn btn-default"> 
								Otvori nalog
							</button>
						</div>
					</div>
				 </div>
				 <div class="panel-body">
					
					<div class="row">
						<div class="col-md-4">
							<b>Opis kvara :</b> {{nalog.opis}}
						</div>
						<div class="col-md-4">
							<b>Pretp. kvara :</b>  {{nalog.pretpostavka}}
						</div>
						<div class="col-md-4">
							<b>ID naloga :</b> {{nalog._id}}
						</div>
					</div>
						
					</div>
				   </div>
			     </div>
			  </div>
            </div>
			

            <div class="modal fade" id="myModal" tabindex="-1" role="dialog">
              <div class="modal-dialog">
                <div class="modal-content">
                  <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label=
                    "Close"><span aria-hidden="true">&#215;</span></button>

                    <h4 class="modal-title">Unos servisnog naloga</h4>
                  </div>

                  <div class="modal-body">
                    <form role="form">
                      <h4>Kupac</h4>

                      <div class="form-group kupacInfo">
                        <label for="imeKupca">Ime kupca</label> <input type="text" class=
                        "form-control" id="ime" placeholder="Unesi ime kupca" />
                        <label for="prezime">Prezime kupca</label> <input type=
                        "text" class="form-control" id="prezime" placeholder=
                        "Unesi prezime kupca" />
                      </div><br />

                      <h4>Ure&#273;aj</h4>

                      <div class="form-group uredjajInfo">
                        <label for="vrstaUredjaja">Vrsta ure&#273;aja</label>
                        <select class="form-control" id="vrsta">
                          <option>
                            1
                          </option>

                          <option>
                            2
                          </option>

                          <option>
                            3
                          </option>

                          <option>
                            4
                          </option>
                        </select> <label for="markaUredjaja">Marka Ure&#273;aja</label>
                        <select class="form-control" id="marka">
                          <option>
                            1
                          </option>

                          <option>
                            2
                          </option>

                          <option>
                            3
                          </option>

                          <option>
                            4
                          </option>
                        </select> <label for="modelUredjaja">Model uredjaja</label>
                        <input type="text" class="form-control" id="model"
                        placeholder="Unesi model ure&#273;aja" />
                      </div><br />

                      <h4>Kvar</h4>

                      <div class="form-group kvarInfo">
                        <label for="opis Kvara">Opis kvara</label> 
                        <textarea class="form-control" rows="5" id="opiskvara">
</textarea><br />
                        <label for="pretpostavkaKvara">Pretpostavka kvara</label> 
                        <textarea class="form-control" rows="5" id="pretpkvara">
</textarea><br />
                        <input type="text" class="form-control" id="pretpcijena"
                        placeholder="Unesi cijenu" />
                      </div><br />

                      <h4>Dodatno</h4>

                      <div class="form-group dodatnoInfo">
                        <label for="serviser">Cijena</label> <input type="text" class=
                        "form-control" id="serviser" placeholder="Unesi kome ide na servis" />
                        <label for="dodatnaOprema">Dodatno</label> <input type="text"
                        class="form-control" id="dodatno" placeholder="Adapter,torba ..." />
                      </div>
                    </form>
							<button class="btn btn-primary" onclick="unesiNalog()">
								Unesi servisni nalog
							</button>
                  </div>

                  <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss=
                    "modal">Zatvori</button>
                  </div>
                </div><!-- /.modal-content -->
              </div><!-- /.modal-dialog -->
            </div><!-- /.modal -->
			
			
			<div class="modal fade" id="nalozi" tabindex="-1" role="dialog">
              <div class="modal-dialog">
                <div class="modal-content">
                  <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label=
                    "Close"><span aria-hidden="true">&#215;</span></button>

                    <h4 class="modal-title">Unos servisnog naloga</h4>
                  </div>

					  <div class="modal-body">
                    
                      </div>
					  
					  <br />

                      <h4>Kvar</h4>

                      <div class="form-group kvarInfo">
                        <label for="opis Kvara">Opis kvara</label> 
                        <textarea class="form-control" rows="5" id="opiskvara">
</textarea><br />
                        <label for="pretpostavkaKvara">Pretpostavka kvara</label> 
                        <textarea class="form-control" rows="5" id="pretpkvara">
</textarea><br />
                        <input type="text" class="form-control" id="pretpcijena"
                        placeholder="Unesi cijenu" />
                      </div><br />

                      <h4>Dodatno</h4>

                      <div class="form-group dodatnoInfo">
                        <label for="serviser">Cijena</label> <input type="text" class=
                        "form-control" id="serviser" placeholder="Unesi kome ide na servis" />
                        <label for="dodatnaOprema">Dodatno</label> <input type="text"
                        class="form-control" id="dodatno" placeholder="Adapter,torba ..." />
                      </div>
                    </form>
							<button class="btn btn-primary" onclick="unesiNalog()">
								Unesi servisni nalog
							</button>
                  </div>

                  <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss=
                    "modal">Zatvori</button>
                  </div>
                </div><!-- /.modal-content -->
              </div><!-- /.modal-dialog -->
            </div><!-- /.modal -->
			
			
			
          </div>
        </div>
      </div>
    </div><!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js" type=
    "text/javascript">
</script> 
<!-- Include all compiled plugins (below), or include individual files as needed -->
     <script src="static/js/bootstrap.min.js" type="text/javascript">
</script><script src=
"https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.10.0/js/bootstrap-select.min.js"
    type="text/javascript">
</script> <script type="text/javascript">


    $('#myModal').on('shown.bs.modal', function () {
    $('#myInput').focus();
    });

 function ajax(data,url,sucess){
		console.log('ušlo u metodu');
			$.ajax({url: url,
					success: function(result){
						sucess(result);
					},
					data : data
				});
	}
	
	function getSelected(id){
		return $('#'+id)[0].value;
	}
	function getCheckbox(id){
	
		return $('#'+id).is(':checked');
		
	}
	
	var dohvatiNaloge = function(){
		ajax({},'/dohvatinaloge',function(result){
			var nalozi = new Vue({
			  el: '#nalozi',
			  data: {
				nalozi: result
			  }
			});
		});
	}
	
	

	
	
	function dohvatiZaSelection(id){
		ajax({selection : id},'/selection',function(result){
			console.log(result);
			var selection = document.getElementById(id);
			
			console.log(selection);
			console.log(selection.length);
			selection.innerHTML = "";
			result.forEach(function(row){
			
				var opt = document.createElement('option');
				opt.value = row.marka;
				opt.innerHTML = row.marka;
				selection.add(opt);
			});
		});
	}
	//dohvatiZaSelection('marke')
	
	function dohvatiUneseno(){
	
		var nalog = {
			ime:getSelected('ime'),
			prezime:getSelected('prezime'),
			vrsta:getSelected('vrsta'),
			marka:getSelected('marka'),
			model:getSelected('model'),
			opiskvara:getSelected('opiskvara'),
			pretpkvara:getSelected('pretpkvara'),
			pretpcijena:getSelected('pretpcijena'),
			serviser:getSelected('serviser'),
			dodatno:getSelected('dodatno')
			}
			
		return nalog;
	}
	
	
	
	function unesiNalog()
	{
		var nalog = dohvatiUneseno();
		ajax(nalog,'/nalognovi',function(result){
			console.log(result);
		});
	}
	
	
    </script>
  </div>
</body>
</html>

